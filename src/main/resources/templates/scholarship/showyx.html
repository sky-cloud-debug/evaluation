<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>奖学金</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/css/layui.css" media="all">
    <script src="/jquery-3.4.1/jquery-3.4.1.min.js"></script>
    <script src="/layui.all.js"></script>
</head>
<body>
<div class="layui-inline">
    <div class="layui-input-inline">
        <input id="Sno" type="tel"   class="layui-input" placeholder="请搜索学号">
    </div>
    <div class="layui-input-inline">
        <div class="site-demo-button" id="layerDemo" style="margin-bottom: 0;">
            <button data-method="notice" class="layui-btn">查 询</button>
        </div>
    </div>
</div>

<div style="z-index: 1" class="layui-form">
    <table class="layui-table">
        <colgroup>

            <col width="150">
            <col width="150">
            <col width="150">
            <col width="200">
            <col>
        </colgroup>
        <thead>
        <tr>
            <th>学号</th>
            <th>姓名</th>
            <th>专业</th>
            <th>奖项</th>
        </tr>
        </thead>
        <tbody id="tb">
        </tbody>
    </table>
</div>
<div id="demo7"></div>
<script>
    $(function () {
        var Sname="";
        var Snumber="";
        var Smajor="";
        var SscholarshipLevel="";
        var err="输入学号有误！";
        var pg="";
        var arrdata=[];
        var Jdata;
        $.ajax({
            type: "POST",
            url: "/BasicController/yxAward",
            success: function (data) {
                Jdata=JSON.parse(data);
                $.each(Jdata,function (i,v) {
                    if(i>=1){
                        var str="<tr id="+v.number+ ">\n" +
                            "            <td>"+v.number+"</td>\n" +
                            "            <td>"+v.name+"</td>\n" +
                            "            <td>"+v.class_major+"</td>\n" +
                            "            <td>"+v.scholarshipLevel+"</td>\n" +
                            "        </tr>"
                        arrdata.push(str);
                        // $('div').append(str);
                    }
                })
                layui.use(['laypage', 'layer'], function() {
                    var laypage = layui.laypage
                        , layer = layui.layer
                        , $ = layui.jquery;
                    var active = {
                        notice: function(){
                            //示范一个公告层
                            layer.open({
                                type: 1
                                ,title: false //不显示标题栏
                                ,closeBtn: false
                                ,area: '300px;'
                                ,shade: 0.8
                                ,id: 'LAY_layuipro' //设定一个id，防止重复弹出
                                ,btn: ['我知道了']
                                ,btnAlign: 'c'
                                ,moveType: 1 //拖拽模式，0或者1
                                ,content: "<h2>"+err+"</h2>" +"<br>姓名："+ Sname+'<br>学号：'+Snumber+"<br>专业："+Smajor+"<br>奖项："+SscholarshipLevel+"<br>你的信息在第"+pg+"页"
                                ,success: function(layero){
                                    var btn = layero.find('.layui-layer-btn');
                                    btn.find('.layui-layer-btn0').attr({
                                        href: '#'
                                    });
                                }
                            });
                        }
                    };
                    $('#layerDemo .layui-btn').on('click', function(){
                        var othis = $(this), method = othis.data('method');
                        active[method] ? active[method].call(this, othis) : '';
                    });
                    laypage.render({
                        elem: 'demo7'
                        , count: arrdata.length
                        , limit: 15
                        , layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']
                        , jump: function (obj) {
                            // console.log(obj.curr);
                            $("#tb>tr").remove();
                            for (var i = (obj.curr - 1) * 15; i < obj.curr * 15; i++) {
                                $("#tb").append(arrdata[i]);
                            }
                        }
                    });
                })
            },
            error:function (e) {
                console.log(e);
            }
        })
        info();
        function info() {
            $('body').delegate('#Sno','propertychange input',function(){
                //实时获取文本内容
                var $Sno=$(this).val();
                //console.log($Sno);
                if($Sno.length==10) {
                    $(Jdata).each(function (index,item) {
                        if(index>0){
                            if(item.number==$Sno){
                                pg=parseInt(index/15)+1;
                                Sname=item.name;
                                Snumber=item.number;
                                Smajor=item.class_major;
                                Sbonus_name=item.scholarshipLevel;

                                err="查询成功:";
                            }
                        }
                    })
                }
                //  console.log(Sname);
            });
        }
    });
</script>

</body>
</html>